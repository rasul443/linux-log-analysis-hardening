1. Включение auditd

Запускаем и включаем службу аудита, чтобы система начала отслеживать действия.

sudo systemctl start auditd
sudo systemctl enable auditd
![Скриншот](https://github.com/rasul443/linux-log-analysis-hardening/blob/main/photo_2025-11-22_10-58-31.jpg)

Это активирует auditd и делает так, чтобы он всегда запускался при загрузке.

2. Проверка статуса

Смотрим, работает ли служба и какие правила сейчас активны.

sudo systemctl status auditd
sudo auditctl -s



Первая команда показывает состояние службы, вторая выводит текущие настройки аудита.

3. Добавление правила

Добавляем наблюдение за файлом /etc/passwd. Это главный файл со всеми учетными записями, поэтому логично отслеживать любые его изменения.

sudo auditctl -w /etc/passwd -p wa -k passwd_changes


Объяснение:

-w — какой файл отслеживать.

-p wa — следить за изменением и атрибутами (write, attribute).

-k passwd_changes — тег для удобного поиска.

4. Создание события

Делаем действие, которое попадет в лог. Например, открываем файл /etc/passwd. Даже если ты ничего не изменишь — факт открытия уже создаёт запись.

sudo nano /etc/passwd


После выхода auditd зарегистрирует событие.

5. Просмотр логов

Теперь ищем все события, у которых есть ключ passwd_changes, который мы задали.

sudo ausearch -k passwd_changes


Эта команда вытащит список логов, связанных с изменениями файла /etc/passwd.

6. Полный лог auditd

При необходимости можно посмотреть весь лог:

sudo cat /var/log/audit/audit.log
